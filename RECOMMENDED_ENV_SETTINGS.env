# Рекомендуемые настройки для повышения стабильности OpenAI соединений

# === БАЗОВЫЕ НАСТРОЙКИ ===
OPENAI_API_KEY=sk-your-api-key-here
REALTIME_MODEL=gpt-4o-realtime-preview-2024-10-01
REALTIME_WS_URL=wss://api.openai.com/v1/realtime

# === УЛУЧШЕННЫЕ ТАЙМАУТЫ ДЛЯ СТАБИЛЬНОСТИ ===
# Увеличены для лучшей работы с нестабильными соединениями
WS_CONNECT_TIMEOUT=30          # Было: 15, стало: 30 (таймаут подключения)
WS_PING_INTERVAL=45           # Было: 30, стало: 45 (интервал ping)
WS_PING_TIMEOUT=20            # Было: 15, стало: 20 (таймаут ping)

# === НАСТРОЙКИ ПУЛА СОЕДИНЕНИЙ ===
WS_POOL_SIZE=5                # Было: 3, стало: 5 (размер пула)
WS_MAX_USERS_PER_CONNECTION=15 # Было: 20, стало: 15 (пользователей на соединение)
WS_POOL_STRATEGY=least_connections

# === ТАЙМАУТЫ ОТВЕТОВ ===
RESPONSE_TIMEOUT=15           # Было: 10, стало: 15 (таймаут первого ответа)

# === ПЕРЕПОДКЛЮЧЕНИЯ И УСТОЙЧИВОСТЬ ===
WS_MAX_RETRIES=15            # Было: 10, стало: 15 (максимум попыток переподключения)

# === ДОПОЛНИТЕЛЬНЫЕ ПАРАМЕТРЫ СТАБИЛЬНОСТИ ===
# ✅ Эти параметры ДОБАВЛЕНЫ в env.py и активны по умолчанию

# Мониторинг и очистка
WS_HEALTH_CHECK_INTERVAL=300    # Интервал проверки здоровья (5 минут)
WS_CLEANUP_INTERVAL=60          # Интервал очистки ресурсов (1 минута)
WS_MAX_RESPONSE_MONITOR_TIME=30 # Максимальное время мониторинга response

# Circuit Breaker
WS_CB_FAILURE_THRESHOLD=5       # Количество неудач для открытия circuit breaker
WS_CB_RECOVERY_TIMEOUT=300      # Время восстановления circuit breaker (5 минут)

# Адаптивные таймауты
WS_ADAPTIVE_TIMEOUTS=true       # Включить адаптивные таймауты
WS_BASE_PING_TIMEOUT=15         # Базовый ping timeout
WS_MAX_PING_TIMEOUT=60          # Максимальный ping timeout

# === ОСТАЛЬНЫЕ НАСТРОЙКИ (без изменений) ===
OPENAI_TEMPERATURE=1.1
MAX_RESPONSE_LENGTH=1500
LOG_LEVEL=INFO

# Telegram
TG_BOT_TOKEN=your-telegram-bot-token

# YClients
YCLIENTS_BEARER_TOKEN=your-yclients-token
YCLIENTS_COMPANY_ID=your-company-id

# === ПРИМЕЧАНИЯ ===
# 1. Увеличенные таймауты помогают справляться с нестабильными соединениями
# 2. Уменьшенное количество пользователей на соединение снижает нагрузку
# 3. Больший размер пула обеспечивает лучшее распределение нагрузки
# 4. Дополнительные параметры можно включить по необходимости

# === МОНИТОРИНГ ===
# После применения настроек следите за логами на предмет:
# - Сообщений о circuit breaker
# - Частоты переподключений
# - Ошибок таймаутов
# - Использования памяти
